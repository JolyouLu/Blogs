# Liunx命令速查手册

## Liunx命令

### 用户与权限

| 命令                             | 说明                                                         |
| -------------------------------- | ------------------------------------------------------------ |
| su root                          | 切换到root用户                                               |
| userdel -r                       | 删除用户                                                     |
| chmod u=rwx,g=rwx,o=rx file/     | u文件拥有者权限 g同组用户权限 o其它用户权限  r：读 w：写 r：执行或切换 |
| chmod -R u=rwx,g=rwx,o=rx file/* | `-R`迭代设置 u文件拥有者权限 g同组用户权限 o其它用户权限  r：读 w：写 r：执行或切换 |
| chmod 777 xxx.sh                 | 赋予某个sh文件可执行的权限                                   |
| usermod -a -G groupA user        | 将user用户添加到groupA 组中(不会立刻原来组)                  |

### 磁盘

| 命令                        | 说明                   |
| --------------------------- | ---------------------- |
| df -h                       | 查看磁盘分区与磁盘空间 |
| cat /dev/null >catalina.out | 清空catalina.out文件   |

### CPU占用高线程排除

| 命令                                                | 说明                        |
| --------------------------------------------------- | --------------------------- |
|top -Hp <进程ID>|查看指定进程中线程使用情况|
| jstack -l 1 \| grep $(printf '%x\n' <线程ID>) -A10 | 查看cpu使用高的线程堆栈信息 |

## 其它服务

### Nginx

| 命令                                                         | 说明                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| ./sbin/nginx                                                 | 默认方式启动                                                 |
| /usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf | 指定配置文件启动nginx                                        |
| ./sbin/nginx -s stop                                         | 强制性停止                                                   |
| ./sbin/nginx -s quit                                         | 等待请求处理完停止                                           |
| ./sbin/nginx -t                                              | 检查配置文件是否有错误                                       |
| ./sbin/nginx -s reload                                       | 热装载配置文件(nginx修改配置文件后无需重启，直接执行命令热装载配置) |
| ./sbin/nginx -s reopen                                       | 重新打开日志文件(在生产环境中日志文件过大后备份新建后需要重新关联日志位置不然日志还是打印在久的文件中，即使你修改了名字) |

### Redis

| 命令                            | 说明        |
| ------------------------------- | ----------- |
| ./bin/redis-server ./redis.conf | 启动redis   |
| ./bin/redis-cli shutdown        | 关闭redis   |
| ./bin/redis-cli -p 6379         | 接本地redis |

### Zookeeper

> 首先确保liunx是否安装了nc命令 `yum install -y nc`
>
> 命令使用格式`echo zk 命令|nc ip port`

| 命令 | 说明                                                         |
| ---- | ------------------------------------------------------------ |
|conf | 3.3.0版本引入的。打印出服务相关配置的详细信息              |
|cons | 3.3.0版本引入的。列出所有连接到这台服务器的客户端全部连接/会话详细信息。包括"接受/发送"的包数量、会话id、操作延迟、最后的操作执行等等信息 |
|crst | 3.3.0版本引入的。重置所有连接的连接和会话统计信息          |
| dump | 列出那些比较重要的会话和临时节点。这个命令只能在leader节点上有用 |
| envi | 打印出服务环境的详细信息                                   |
| reqs | 列出未经处理的请求                                           |
| ruok | 测试服务是否处于正确状态。如果确实如此，那么服务返回"imok"，否则不做任何相应 |
| stat | 输出关于性能和连接的客户端的列表                           |
| srst | 重置服务器的统计                                           |
| srvr | 3.3.0版本引入的。列出连接服务器的详细信息                    |
| wchs | 3.3.0版本引入的。列出服务器watch的详细信息                 |
| wchc | 3.3.0版本引入的。通过session列出服务器watch的详细信息，它的输出是一个与watch相关的会话的列表。 |
| wchp | 3.3.0版本引入的。通过路径列出服务器watch的详细信息。它输出一个与session相关的路径|
| mntr | 3.4.0版本引入的。输出可用于检测集群健康状态的变量列表        |

### Tomcat

| 命令                        | 说明                 |
| --------------------------- | -------------------- |
| cat /dev/null >catalina.out | 清空catalina.out文件 |

